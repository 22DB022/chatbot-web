<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>マルチメディア検定 学習チャット</title>
    <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>
    <!-- サイドバー -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <button class="new-chat-btn" onclick="resetConversation()">
                <span class="icon">➕</span>
                新しいチャット
            </button>
        </div>

        <div class="sidebar-content">
            <!-- 統計情報 -->
            <div class="sidebar-stats">
                <div class="stat-item">
                    <span class="stat-icon">📚</span>
                    <div>
                        <div class="stat-label">登録PDF</div>
                        <div class="stat-value" id="pdfCount">-</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">📄</span>
                    <div>
                        <div class="stat-label">総ページ数</div>
                        <div class="stat-value" id="totalPages">-</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">🔍</span>
                    <div>
                        <div class="stat-label">チャンク数</div>
                        <div class="stat-value" id="totalChunks">-</div>
                    </div>
                </div>
            </div>

            <!-- PDFアップロード -->
            <div class="sidebar-section">
                <button class="sidebar-btn upload-btn" onclick="document.getElementById('pdfFileInput').click()">
                    <span class="icon">📤</span>
                    PDFを追加
                </button>
                <input type="file" id="pdfFileInput" accept=".pdf" style="display: none;" onchange="handleFileSelect(event)">
                
                <div id="uploadProgress" class="upload-progress" style="display: none;">
                    <div class="progress-bar">
                        <div id="progressBarFill" class="progress-fill"></div>
                    </div>
                    <div id="uploadStatus" class="upload-status">アップロード中...</div>
                </div>
            </div>

            <!-- PDF一覧 -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">登録済みPDF</h3>
                <ul id="pdfList" class="pdf-list">
                    <li class="pdf-loading">読み込み中...</li>
                </ul>
            </div>
        </div>

        <div class="sidebar-footer">
            <div class="db-status" id="dbType">接続確認中...</div>
        </div>
    </div>

    <!-- サイドバー切り替えボタン（モバイル用） -->
    <button id="sidebarToggle" class="sidebar-toggle" onclick="toggleSidebar()">
        ☰
    </button>

    <!-- メインコンテンツ -->
    <div class="main-container">
        <!-- チャットエリア -->
        <div class="chat-wrapper">
            <div id="chatContainer" class="chat-container">
                <!-- ウェルカムメッセージ -->
                <div class="welcome-screen">
                    <div class="welcome-icon">🎓</div>
                    <h1 class="welcome-title">マルチメディア検定<br>学習アシスタント</h1>
                    
                    <!-- クイックアクション -->
                    <div class="quick-actions-grid">
                        <button class="quick-action-card" onclick="sendQuickAction('quiz')">
                            <div class="card-icon">📝</div>
                            <div class="card-title">問題を出す</div>
                            <div class="card-desc">理解度をチェック</div>
                        </button>
                        <button class="quick-action-card" onclick="sendQuickAction('term')">
                            <div class="card-icon">📖</div>
                            <div class="card-title">専門用語解説</div>
                            <div class="card-desc">重要な用語を学ぶ</div>
                        </button>
                        <button class="quick-action-card" onclick="sendQuickAction('past')">
                            <div class="card-icon">📚</div>
                            <div class="card-title">過去問に挑戦</div>
                            <div class="card-desc">試験レベルの問題</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 入力エリア -->
        <div class="input-wrapper">
            <div class="input-container">
                <div class="input-box">
                    <textarea 
                        id="questionInput" 
                        placeholder="メッセージを入力してください..."
                        rows="1"
                        onkeydown="handleKeyDown(event)"
                        oninput="autoResize(this)"
                    ></textarea>
                    <button id="sendButton" class="send-button" onclick="sendQuestion()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M7 11L12 6L17 11M12 18V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                <div class="input-footer">
                    マルチメディア検定の学習をサポートします
                </div>
            </div>
        </div>
    </div>

    <!-- エラーメッセージ -->
    <div id="errorMessage" class="error-toast"></div>

    <script src="/assets/js/app.js"></script>
</body>
</html>